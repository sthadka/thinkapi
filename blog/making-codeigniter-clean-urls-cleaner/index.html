<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Sukumar Yethadka" />
        <meta name="copyright" content="Sukumar Yethadka" />

<meta name="keywords" content="codeigniter, Codeigniter, " />
        <title>Making Codeigniter clean URLs cleaner - thinkAPI
</title>
        <!-- Le styles -->
        <link rel="stylesheet" type="text/css" href="../../theme/css/bootstrap.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../../theme/css/bootstrap-responsive.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../../theme/css/fonts.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../../theme/css/code.css" media="screen">
    </head>

    <body>

        <div class="navbar">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="brand" href="../..">thinkAPI</a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right">
                            <li><a href="#blog">Blog</a></li>
                            <li><a href="#projects">Projects</a></li>
                            <li><a href="#photos">Photos</a></li>
                            <li><a href="#contact">Contact</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>

        <div class="container-fluid">
<article>
    <div class="row-fluid">

        <div class="span9">
            <div class="row-fluid">
                <header class="page_header">
                <h1>Making Codeigniter clean URLs cleaner </h1>
                </header>
                <p>Usually when working with codeigniter you come across the use case where you
need to remove the extra "index" appearing in the URL for purposes
ranging from shorter URLs to SEO.</p>
<p>For example,</p>
<div class="highlight"><pre>Current URL style:
http://example.com/controller/method/category1/category2/page-name
Target URL style:
http://example.com/category1/category2/page-name.html
</pre></div>


<p>As you can see, the difference in the target URL is the absence of the
controller name and the method name and the presence of the extension ".html".
Now, lets see how to achieve this and why the extra extension is required.</p>
<p>Below is my version of .htaccess.</p>
<div class="highlight"><pre>RewriteEngine on

RewriteRule ^([a-z0-9_-]+)\.html$ index.php/page/$1 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !^(index\.php|asset|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L]
</pre></div>


<p>The line that is extra is 3 which redirects all the requests for ".html"; files to the controller named "page".</p>
<p>Now, lets look at the page controller which will handle these requests.</p>
<div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;BASEPATH&#39;</span><span class="p">))</span> <span class="k">exit</span><span class="p">(</span><span class="s1">&#39;No direct script access allowed&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Page</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>

    <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">Controller</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="nf">_remap</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$segment_count</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">uri</span><span class="o">-&gt;</span><span class="na">total_segments</span><span class="p">();</span>
        <span class="nv">$segments</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">uri</span><span class="o">-&gt;</span><span class="na">segment_array</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span><span class="nv">$segment_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Page Title&#39;</span><span class="p">;</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">load</span><span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">elseif</span><span class="p">(</span><span class="nv">$segment_count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">// Single page</span>
        <span class="p">{</span>
            <span class="nv">$page_url</span> <span class="o">=</span> <span class="nv">$segments</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
            <span class="c1">// Handle the page request</span>
        <span class="p">}</span>
        <span class="k">elseif</span><span class="p">(</span><span class="nv">$segment_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">// Page with category</span>
        <span class="p">{</span>


            <span class="nv">$category</span> <span class="o">=</span> <span class="nv">$segments</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
            <span class="nv">$page_url</span> <span class="o">=</span> <span class="nv">$segments</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
            <span class="c1">// Handle the category + page request</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>In this way you can have pages with smaller and cleaner URLs.</p>
<p>Tips:</p>
<ol>
<li>You can use any extension you like. e.g; in case you have static HTML files to server, you can use the extension ".html" for static and ".htm" for non-static files.</li>
<li>You can have any number of URL stubs before the ".html" extension and you can access all these stubs in the controller.</li>
</ol>
<p>Cons:</p>
<ol>
<li>The URL needs an extra extension.</li>
<li>Only one controller per extension.</li>
</ol>
<p>Do let me know what you think about this or if there is any way to improve on this.</p>
<h2>Old comments</h2>
<p><strong>Ruben Müller</strong></p>
<p>Why don't you use the routes.php?</p>
<p><a href="http://codeigniter.com/user_guide/general/routing.html" rel="nofollow">http://codeigniter.com/user_guide/general/routing.html</a></p>
<hr />
<p><strong>Bob</strong></p>
<p>I'm wondering why you would want the extension (.html, .htm, .php, whatever). If you're looking for shorter, cleaner URLs, why not:</p>
<p>Current: <a href="http://example.com/controller/method/category1/category2/page-name" rel="nofollow">http://example.com/controller/method/category1/category2/page-name</a></p>
<p>Target : <a href="http://example.com/controller/method/category1/category2" rel="nofollow">http://example.com/controller/method/category1/category2</a></p>
<p>or to really chop it up:</p>
<p>Target : <a href="http://example.com/category1/category2" rel="nofollow">http://example.com/category1/category2</a></p>
<p>I suppose it makes a difference if your controller/method names are married to your site structure (i.e., <a href="http://example.com/products/view/cat1/cat2" rel="nofollow">http://example.com/products/view/cat1/cat2</a>) or not (<a href="http://example.com/whichpage/displayproducts/cat1/cat2" rel="nofollow">http://example.com/whichpage/displayproducts/cat1/cat2</a>) but at least to the way I code, I'm not seeing the benefits of this method.</p>
<p>Cheers,
Bob</p>
<hr />
<p><strong>Sukumar Yethadka</strong></p>
<p>@Ruben
Using routes is an option. But in order to get URLs like</p>
<p><a href="http://example.com/category1/category2/page-name" rel="nofollow">http://example.com/category1/category2/page-name</a></p>
<p>without the controller name and the method name ("index" for example); the route would be (Please note that I haven't tested this below route)</p>
<div class="highlight"><pre><span class="x">$route[&#39;(:any)&#39;] = &#39;page/$1&#39;;</span>
</pre></div>


<p>Then you would be able to use any other controller since all the requests are routed to "page" controller.
Do let me know if there is a better routing method I missed.</p>
<p>@Bob
The main reasons I didn't want</p>
<p>Target : <a href="http://example.com/controller/method/category1/category2" rel="nofollow">http://example.com/controller/method/category1/category2</a></p>
<p>is because my URLs would have looked like</p>
<p><a href="http://example.com/page/index/category1/category2" rel="nofollow">http://example.com/page/index/category1/category2</a></p>
<p>AFAIK, google considers the URL segments to be more important the closer they are to the domain name.</p>
<p>Yes,
Target : <a href="http://example.com/category1/category2" rel="nofollow">http://example.com/category1/category2</a></p>
<p>is quite possible and using routes at that. However, I think we wouldn' t be able to use other controllers because of this (Unless we have some filter that checks for the existence of the controller and then the category). Using extensions helps to map a particular extension to a specific controller whithout affecting any other controllers.</p>
<p>One of the main use cases I can think of is for a small blog similar to wordpress.</p>
<p>Hope that makes sense.</p>
<hr />
<p><strong>Henry Weismann</strong></p>
<p>How about:</p>
<p>Current Url: <a href="http://example.com/controller-method/category1/category2" rel="nofollow">http://example.com/controller-method/category1/category2</a></p>
<p>OR</p>
<p>Current Url: <a href="http://example.com/subfolder-controller-method/category1/category2" rel="nofollow">http://example.com/subfolder-controller-method/category1/category2</a></p>
<p>is because my URLs would have looked like</p>
<p>Target Url: <a href="http://example.com/index.php/controller/method/category1/category2" rel="nofollow">http://example.com/index.php/controller/method/category1/category2</a></p>
<p>OR</p>
<p>Target Url: <a href="http://example.com/index.php/controller/method/index/category1/category2" rel="nofollow">http://example.com/index.php/controller/method/index/category1/category2</a></p>
<div class="highlight"><pre>RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !^(index\.php|asset|robots\.txt)
RewriteRule ^([^/.]+)-([^/.]+)-([^/.]+)/(.*)$ index.php/$1/$2/$3/$4 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !^(index\.php|asset|robots\.txt)
RewriteRule ^([^/.]+)-([^/.]+)/(.*)$ index.php/$1/$2/$3 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !^(index\.php|asset|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L]
</pre></div>


<p>Using Routes:</p>
<div class="highlight"><pre><span class="x">$route[&#39;^([^/.]+)-([^/.]+)/(.*)&#39;] = &quot;$1/$2/$3&quot;;</span>
<span class="x">$route[&#39;^([^/.]+)-([^/.]+)-([^/.]+)/(.*)&#39;] = &quot;$1/$2/$3/$4&quot;;</span>
</pre></div>


<p>I have no idea if that will work as I just wrote it now.  Feel free to test it.</p>
<hr />
<p><strong>Henry Weismann</strong></p>
<p>Should read:
Target Url: <a href="http://example.com/index.php/controller/method/category1/category2" rel="nofollow">http://example.com/index.php/controller/method/category1/category2</a></p>
<p>OR</p>
<p>Target Url: <a href="http://example.com/index.php/subfolder/controller/method/index/category1/category2" rel="nofollow">http://example.com/index.php/subfolder/controller/method/index/category1/category2</a></p>
<hr />
<p><strong>Sukumar Yethadka</strong></p>
<p>@Henry,
Your code looks good, but my aim is to remove the controller and the method name from the URL.
Target URL style: <a href="http://example.com/category1/category2/page-name" rel="nofollow">http://example.com/category1/category2/page-name</a>
Your method is useful to merge the forward slashes in the URL.</p>
<p>Useful code nevertheless, thanks!</p>
<hr />
<p><strong>Sean</strong></p>
<p>One problem I notice about CI Urls is how they look inside of google on your website snippet. They all include a ../ inside the URL have you noticed this and do you have any idea how to remove that ../ it wastes space and is distracting.
Thanks,
Sean</p>
<hr />
<p><strong>Sukumar Yethadka</strong></p>
<p>@Sean,
I didn't really get what you are referring to. You can check the usage of this code snippet on <a href="http://www.fourseasonsvineyards.com/" rel="nofollow">http://www.fourseasonsvineyards.com/</a>
As you can see there are no "../" in the URLs anywhere. Do let me know if I am missing something.</p>
                <aside>
                <nav>
                <ul class="articles_timeline">
                    <li class="next_article"><a href="../../blog/how-to-skip-mysql-replication-counter/" title="Next: How to skip MySQL replication counter">How to skip MySQL replication counter</a> »</li>
                </ul>
                </nav>
                </aside>
<section>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2" 
                href="../../blog/making-codeigniter-clean-urls-cleaner//#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'blog-notmyidea';
        var disqus_identifier = '../../blog/making-codeigniter-clean-urls-cleaner/';
    var disqus_url = '../../blog/making-codeigniter-clean-urls-cleaner/';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>                </div>
            </div>
        </div>
    </div>
</div>
</section>
            </div>
        </div><!--/span-->

        <div class="span3">
            <div class="well sidebar-nav">
                <ul class="nav nav-list">
                    <li class="nav-header">Sukumar Yethadka</li>
                    Some dude
                    <li class="nav-header">Published</li>
                    <time pubdate="pubdate" datetime="2008-10-07T19:19:00">Oct 7, 2008</time>
                    <li class="nav-header">Category</li>
                    <a class="category-link" href="/categories.html#Codeigniter-ref">Codeigniter</a>
                    <li class="nav-header">Tags</li>
                    <ul class="list-of-tags tags-in-article">
                        <li><a href="/tags.html#codeigniter-ref">codeigniter
                            <span>2</span>
</a></li>
                    </ul>
                </ul>
            </div><!--/.well -->
        </div><!--/span-->

    </div>
</article>
        </div><!--/.fluid-container-->

<div class="container-fluid">
    <footer>
    <p>&copy; thinkAPI</p>
    </footer>
</div>        <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>

<script type="text/javascript">
    var disqus_shortname = 'blog-notmyidea';

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
    </body>
</html>